(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/check-detail/check-detail"],{"05af":function(t,e,a){"use strict";a("535a");var i=o(a("b0ce")),n=o(a("7919"));function o(t){return t&&t.__esModule?t:{default:t}}Page((0,i.default)(n.default))},1286:function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i,n=c(a("cc5e")),o=c(a("1c1f"));function c(t){return t&&t.__esModule?t:{default:t}}function s(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}var r=t.getRecorderManager(),d=t.createInnerAudioContext();d.autoplay=!0;var l={data:function(){var t=this.getDate({format:!0});return{textShow:!0,personIndex:0,personArray:["人员1","人员2","人员3"],fixIndex:0,fixArray:["设备1","设备2","设备3"],numberIndex:0,numberArray:["工位1","工位2","工位3"],makeIndex:0,makeArray:["产线1","产线2","产线3"],region:["A","B","C"],micCss:"background:#f7f7f7",micSrc:"../../static/img/mic-close.png",typeIndex:-1,tagFlag:!0,updateIndex:-1,submitColor:"green",seconds:0,micType:"mic",typeList:[{name:"person",text:"人",img:"../../static/img/person.png",choose:"../../static/img/person-after.png"},{name:"machine",text:"机",img:"../../static/img/machine.png",choose:"../../static/img/machine-after.png"},{name:"material",text:"料",img:"../../static/img/material.png",choose:"../../static/img/material-after.png"},{name:"function",text:"法",img:"../../static/img/function.png",choose:"../../static/img/function-after.png"},{name:"ambient",text:"环",img:"../../static/img/ambient.png",choose:"../../static/img/ambient-after.png"},{name:"test",text:"测",img:"../../static/img/test.png",choose:"../../static/img/test-after.png"}],helpShow:!1,dangerArray:["一级","二级","三级"],dangerIndex:0,managerArray:["责任人1","责任人2","责任人3"],managerIndex:0,date:t,show:!1,radioList:["当即整改","限期整改","不确定上升问题解决"],changeObj:{},lastUpdate:-1,changeList:[],current:0,tabList:[],list:[],voicePath:""}},components:{uploadImg:n.default},computed:{},onLoad:function(t){this.id=t.id,o.default.mission.getLastUpdate(this,t.id),o.default.mission.getLastPageData(t.id,this);var e=this;r.onStop(function(t){console.log("recorder stop"+JSON.stringify(t));var a=parseInt(t.duration%6e4/1e3);0==a&&(a=1),e.seconds=a,e.voicePath=t.tempFilePath})},watch:{},methods:(i={dangerChange:function(t){this.dangerIndex=t.target.value},mangerChange:function(t){this.managerIndex=t.target.value},getDate:function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();return"start"===t?a-=60:"end"===t&&(a+=2),i=i>9?i:"0"+i,n=n>9?n:"0"+n,"".concat(a,"-").concat(i,"-").concat(n)},bindDateChange:function(t){this.date=t.target.value},changeTextShow:function(t){this.textShow=!this.textShow},changePerson:function(t){this.personIndex=t.detail.value},changeFix:function(t){this.fixIndex=t.detail.value},changeNumber:function(t){this.numberIndex=t.detail.value},changeMake:function(t){this.makeIndex=t.detail.value},changeType:function(t){this.typeIndex=t.currentTarget.dataset.index},submit:function(){var t=this.changeObj.id;this.getNextData(t)},modalSubmit:function(){var t=this,e=t.changeObj.id,a=t.updateIndex;o.default.mission.list.forEach(function(e,i){e.id==t.changeObj.id&&(e.updateIndex=a)}),o.default.mission.changeList.forEach(function(e,i){e.id==t.changeObj.id&&(e.updateIndex=a)}),t.closeModal(),t.getNextData(e)},clearVoice:function(){this.voicePath=""},startRecord:function(){console.log("开始录音"),this.micSrc="../../static/img/mic-open.png",this.micCss="background:#74bbe6",this.tagFlag=!1,r.start()},endRecord:function(){var t=this;console.log("录音结束"),t.micSrc="../../static/img/mic-close.png",t.micCss="background:#f7f7f7",t.tagFlag=!0,setTimeout(function(){r.stop()},500)},playVoice:function(){console.log("播放录音"),this.voicePath&&(d.src=this.voicePath,d.play(),console.log("innerAudioContext:",d))},openHelp:function(){this.helpShow=!this.helpShow}},s(i,"getDate",function(t){var e=new Date,a=e.getFullYear(),i=e.getMonth()+1,n=e.getDate();return"start"===t?a-=60:"end"===t&&(a+=2),i=i>9?i:"0"+i,n=n>9?n:"0"+n,"".concat(a,"-").concat(i,"-").concat(n)}),s(i,"openModal",function(t){var e=this,a=t.currentTarget.dataset.index;0==a?(o.default.mission.list.forEach(function(t,i){t.id==e.changeObj.id&&(t.updateIndex=a)}),o.default.mission.changeList.forEach(function(t,i){t.id==e.changeObj.id&&(t.updateIndex=a)}),e.getNextData(e.changeObj.id)):(e.updateIndex=a,e.show=!e.show)}),s(i,"closeModal",function(t){this.show=!this.show}),s(i,"updateChangeList",function(t){o.default.mission.updateChangeList(t)}),s(i,"getChangeCount",function(){o.default.mission.getChangeCount()}),s(i,"changSwiper",function(t){o.default.mission.changSwiper(t)}),s(i,"doneChange",function(t){var e=t.currentTarget.dataset.dindex,a=t.currentTarget.dataset.id;o.default.mission.doneChange(t,this),console.log("doneIndex===",e),0!=e&&2!=e||this.getNextData(a)}),s(i,"getNextData",function(t){Object.assign(this.$data,this.$options.data());var e=o.default.mission.list,a=-1;for(var i in e)t==e[i].id&&(a=parseInt(i)+1);e[a]&&(this.changeObj=e[a],o.default.mission.getLastUpdate(this,e[a].id))}),s(i,"radioChange",function(t){console.log(t)}),i)};e.default=l}).call(this,a("543d")["default"])},"12e6":function(t,e,a){"use strict";a.r(e);var i=a("2ea9"),n=a("231b");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("70bf");var c=a("2877"),s=Object(c["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=s.exports},"231b":function(t,e,a){"use strict";a.r(e);var i=a("4c4d"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},"2ea9":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{directives:[{name:"show",rawName:"v-show",value:t.popshow,expression:"popshow"}],staticClass:"lvv-popup"},[a("view",{staticClass:"lvv-popupmark",attrs:{eventid:"8a24f12c-0"},on:{click:t.close}}),a("view",{staticClass:"lvv-popupcontent",class:"top"!=t.position||t.hideanimation?"left"!=t.position||t.hideanimation?"right"!=t.position||t.hideanimation?"bottom"!=t.position||t.hideanimation?"top"==t.position&&t.hideanimation?".ht":"left"==t.position&&t.hideanimation?".hl":"right"==t.position&&t.hideanimation?".hr":"bottom"==t.position&&t.hideanimation?".hb":"":".pb":".pr":".pl":".pt",attrs:{eventid:"8a24f12c-2"},on:{click:t.close}},[a("view",{staticClass:"realcontent",attrs:{eventid:"8a24f12c-1"},on:{click:function(t){t.stopPropagation()}}},[t._t("default",null,{mpcomid:"8a24f12c-0"})],2)])])},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},"388a":function(t,e,a){},"4c4d":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i={props:{position:{type:String,default:null},imgCount:{type:Number,default:0},imgMaxCount:{type:Number,default:0},videoCount:{type:Number,default:0},videoMaxCount:{type:Number,default:0}},data:function(){return{popshow:!1,hideanimation:!1}},methods:{show:function(){this.popshow=!0},close:function(){var t=this;t.hideanimation=!0,null==t.position?t.popshow=!1:setTimeout(function(){t.popshow=!1,t.hideanimation=!1},500)}}};e.default=i},"70bf":function(t,e,a){"use strict";var i=a("cd12"),n=a.n(i);n.a},"78ec":function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"choose-img-main"},[a("view",{staticClass:"image-choose"},[t._l(t.imgArray,function(e,i){return a("block",{key:i},[a("view",{staticClass:"choose-img-top"},[a("view",[a("image",{staticClass:"upload-img",attrs:{src:e}}),a("text",{staticClass:"close-img",attrs:{"data-index":i,eventid:"413c81b4-0-"+i},on:{click:t.closeImg}},[t._v("X")])])])])}),t.count>0?a("view",[a("image",{staticClass:"image-camera",attrs:{src:"../../static/img/camera.png",eventid:"413c81b4-1"},on:{click:t.toshow}})]):t._e()],2),t.videoSrc?a("view",[a("view",[a("video",{staticClass:"img-video",attrs:{controls:"",src:t.videoSrc}})]),a("view",[a("uni-tag",{attrs:{text:"删除视频",circle:!0,type:"primary",eventid:"413c81b4-2",mpcomid:"413c81b4-0"},on:{click:t.clearVideo}})],1)]):t._e(),a("lvv-popup",{ref:"lvvpopref",attrs:{position:"bottom",imgCount:t.imgArray.length,imgMaxCount:t.maxCount,videoCount:t.videoSrc.length,videoMaxCount:t.videoMaxCount,mpcomid:"413c81b4-1"}},[a("view",{staticClass:"img-popup"},[a("view",{attrs:{"data-type":"camera",eventid:"413c81b4-3"},on:{click:t.chooseImg}},[a("text",[t._v("拍摄照片（"+t._s(t.imgCount)+"/"+t._s(t.imgMaxCount)+"）")])]),a("view",{attrs:{"data-type":"camera",eventid:"413c81b4-4"},on:{click:t.chooseVideo}},[a("text",[t._v("拍摄视频（"+t._s(t.videoCount)+"/"+t._s(t.videoMaxCount)+"）")])]),a("view",{attrs:{"data-type":"album",eventid:"413c81b4-5"},on:{click:t.chooseImg}},[a("text",[t._v("从手机相册选择照片（"+t._s(t.imgCount)+"/"+t._s(t.imgMaxCount)+"）")])]),a("view",{attrs:{"data-type":"album",eventid:"413c81b4-6"},on:{click:t.chooseVideo}},[a("text",[t._v("从手机相册选择视频（"+t._s(t.videoCount)+"/"+t._s(t.videoMaxCount)+"）")])])])])],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})},7919:function(t,e,a){"use strict";a.r(e);var i=a("faf9"),n=a("82ba");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("9d7a");var c=a("2877"),s=Object(c["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=s.exports},"82ba":function(t,e,a){"use strict";a.r(e);var i=a("1286"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},"8c8e":function(t,e,a){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=n(a("12e6"));function n(t){return t&&t.__esModule?t:{default:t}}var o={props:{},components:{lvvPopup:i.default},data:function(){return{videoMaxCount:1,maxCount:9,count:9,videoSrc:"",imgArray:[],imgSrc:""}},methods:{toshow:function(){this.$refs.lvvpopref.show()},toclose:function(){this.$refs.lvvpopref.close()},chooseImg:function(e){var a=e.currentTarget.dataset.type,i=this,n=i.count;t.chooseImage({count:n,sourceType:[a],success:function(t){for(var e in t.tempFilePaths)i.imgArray.push(t.tempFilePaths[e]);i.count=n-t.tempFilePaths.length,i.toclose()}})},closeImg:function(t){var e=t.currentTarget.dataset.index;this.imgArray.splice(e,1),this.count=this.count+1},chooseVideo:function(e){var a=e.currentTarget.dataset.type,i=this;t.chooseVideo({count:i.videoMaxCount,sourceType:[a],success:function(t){i.videoSrc=t.tempFilePath,i.toclose()}})},clearVideo:function(t){this.videoSrc=""}}};e.default=o}).call(this,a("543d")["default"])},"9cab":function(t,e,a){"use strict";a.r(e);var i=a("8c8e"),n=a.n(i);for(var o in i)"default"!==o&&function(t){a.d(e,t,function(){return i[t]})}(o);e["default"]=n.a},"9d7a":function(t,e,a){"use strict";var i=a("d12a"),n=a.n(i);n.a},"9f25":function(t,e,a){"use strict";var i=a("388a"),n=a.n(i);n.a},cc5e:function(t,e,a){"use strict";a.r(e);var i=a("78ec"),n=a("9cab");for(var o in n)"default"!==o&&function(t){a.d(e,t,function(){return n[t]})}(o);a("9f25");var c=a("2877"),s=Object(c["a"])(n["default"],i["a"],i["b"],!1,null,null,null);e["default"]=s.exports},cd12:function(t,e,a){},d12a:function(t,e,a){},faf9:function(t,e,a){"use strict";var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("view",{staticClass:"check-main"},[a("view",{staticClass:"mission-list-top"},[1==t.changeObj.doneIndex?a("block",[a("view",{staticClass:"mission-left-hr",class:"nok-color-"+t.changeObj.updateIndex})]):a("block",[a("view",{staticClass:"mission-left-hr",class:"tab-color-"+t.changeObj.doneIndex})]),a("view",{staticClass:"mission-list-title"},[a("view",{staticClass:"mission-list-name"},[a("view",{staticClass:"list-name-left"},[a("text",[t._v(t._s(t.changeObj.name))])]),a("view",{staticClass:"list-name-right"},[a("text",{staticClass:"icon-questionfill",staticStyle:{color:"#178ed7","font-size":"48rpx"},attrs:{eventid:"5bfe5d08-0"},on:{click:t.openHelp}})])]),a("view",{staticClass:"record-detail-choose"},t._l(t.changeObj.doneArray,function(e,i){return a("block",{key:i},[a("view",{staticClass:"detail-choose-item",style:{width:100/t.changeObj.doneArray.length+"%"},attrs:{"data-dindex":i,"data-index":t.index,"data-id":t.changeObj.id,eventid:"5bfe5d08-1-"+i},on:{click:t.doneChange}},[a("view",{staticClass:"mission-choose-item",class:t.changeObj.doneIndex!=i?"choose-item-word":"tab-color-"+t.changeObj.doneIndex},[t._v(t._s(e))])]),i+1<t.changeObj.doneArray.length?a("block",[a("view",{staticClass:"choose-item-hr"})]):t._e()],1)}))])],1),a("view",{staticClass:"check-div"}),1==t.changeObj.doneIndex?a("block",[a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("分类")]),a("view",{staticClass:"check-type-list"},t._l(t.typeList,function(e,i){return a("block",{key:i},[a("view",{style:i!=t.typeIndex?{color:"#cacaca"}:{color:"#74bbe6"},attrs:{"data-index":i,eventid:"5bfe5d08-2-"+i},on:{click:t.changeType}},[a("view",[a("image",{class:"type-img-"+e.name,attrs:{src:i!=t.typeIndex?e.img:e.choose}})]),a("view",{staticClass:"type-text"},[t._v(t._s(e.text))])])])}))]),a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("审核发现")]),a("view",{staticClass:"check-textarea-top"},[t.textShow?a("block",[a("textarea",{staticClass:"check-textarea",attrs:{placeholder:"请输入审核发现"}})]):t._e()],1)]),a("view",{staticClass:"record-modal-list",staticStyle:{background:"#ffffff",color:"#787878","font-size":"30rpx"}},[a("view",[a("text",[t._v("责任区域")])]),a("view",[a("picker",{attrs:{mode:"multiSelector",range:t.region,eventid:"5bfe5d08-3"},on:{change:t.changeRegin}},[a("view",[t._v(t._s(t.region[0])+" - "+t._s(t.region[1])+" - "+t._s(t.region[2]))])])],1)]),a("view",{staticClass:"record-modal-list",staticStyle:{background:"#ffffff",color:"#787878","font-size":"30rpx"}},[a("view",[a("text",[t._v("责任产线")])]),a("view",[a("picker",{attrs:{range:t.makeArray,mode:"selector",eventid:"5bfe5d08-4"},on:{change:t.changeMake}},[a("view",[t._v(t._s(t.makeArray[t.makeIndex]))])])],1)]),a("view",{staticClass:"record-modal-list",staticStyle:{background:"#ffffff",color:"#787878","font-size":"30rpx"}},[a("view",[a("text",[t._v("责任工位")])]),a("view",[a("picker",{attrs:{range:t.numberArray,mode:"selector",eventid:"5bfe5d08-5"},on:{change:t.changeNumber}},[a("view",[t._v(t._s(t.numberArray[t.numberIndex]))])])],1)]),a("view",{staticClass:"record-modal-list",staticStyle:{background:"#ffffff",color:"#787878","font-size":"30rpx"}},[a("view",[a("text",[t._v("责任设备")])]),a("view",[a("picker",{attrs:{range:t.fixArray,mode:"selector",eventid:"5bfe5d08-6"},on:{change:t.changeFix}},[a("view",[t._v(t._s(t.fixArray[t.fixIndex]))])])],1)]),a("view",{staticClass:"record-modal-list",staticStyle:{background:"#ffffff",color:"#787878","font-size":"30rpx"}},[a("view",[a("text",[t._v("责任人员")])]),a("view",[a("picker",{attrs:{range:t.personArray,mode:"selector",eventid:"5bfe5d08-7"},on:{change:t.changePerson}},[a("view",[t._v(t._s(t.personArray[t.personIndex]))])])],1)]),a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("标准做法")]),a("view",{attrs:{eventid:"5bfe5d08-8"},on:{click:t.changeTextShow}},[a("upload-img",{attrs:{mpcomid:"5bfe5d08-0"}})],1)]),a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("图片证据")]),a("view",{attrs:{eventid:"5bfe5d08-9"},on:{click:t.changeTextShow}},[a("upload-img",{attrs:{mpcomid:"5bfe5d08-1"}})],1)]),a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("录音")]),a("view",{staticClass:"check-record"},[a("view",{staticClass:"check-record-button",attrs:{eventid:"5bfe5d08-10"},on:{touchstart:function(e){t.startRecord()},touchend:function(e){t.endRecord()}}},[a("image",{staticClass:"mic-img",attrs:{src:t.micSrc}}),a("view",{staticClass:"check-mic-div",style:t.micCss},[a("text",[t._v("按住 说话")])])]),t.voicePath?a("block",[a("view",{staticClass:"check-record-play",attrs:{eventid:"5bfe5d08-12"},on:{click:function(e){t.playVoice()}}},[a("view",{staticStyle:{display:"flex","align-items":"center"}},[a("faicon",{attrs:{type:"volume-up",mpcomid:"5bfe5d08-2"}}),a("text",{staticClass:"voice-seconds"},[t._v(t._s(t.seconds)+"''")])],1),a("view",{attrs:{eventid:"5bfe5d08-11"},on:{click:function(e){e.stopPropagation(),t.clearVoice(e)}}},[a("text",{staticClass:"icon-roundclosefill",staticStyle:{"font-size":"50rpx"}})])])]):t._e()],1)]),a("view",{staticClass:"check-image-top check-background"},[a("view",{staticClass:"check-image-title"},[t._v("备注")]),a("view",{staticClass:"check-textarea-top"},[t.textShow?a("block",[a("textarea",{staticClass:"check-textarea",attrs:{placeholder:"请输入备注内容"}})]):t._e()],1)]),a("view",{staticClass:"check-div"})]):t._e(),a("view",{staticClass:"bottom-kongbai"}),a("view",{staticClass:"check-background check-bottom"},[1==t.changeObj.doneIndex?a("block",[a("view",{staticClass:"bottom-menu-right"},t._l(t.changeObj.updateArray,function(e,i){return a("block",{key:i},[a("view",{attrs:{"data-index":i,eventid:"5bfe5d08-13-"+i},on:{click:t.openModal}},[a("view",{staticClass:"check-detail-tag",style:0==i?"background:#ffde00":1==i?"background:#ff9000":2==i?"background:#f46666":""},[t._v(t._s(e))])])])}))]):t._e()],1),a("neil-modal",{attrs:{show:t.show,title:"指定责任人","show-cancel":!1,"confirm-color":"rgb(255,255,255)","confirm-text":"rgb(255,255,255)",eventid:"5bfe5d08-18",mpcomid:"5bfe5d08-3"},on:{close:t.closeModal}},[a("view",{staticClass:"record-modal-list"},[a("view",[a("text",[t._v("问题点")])]),a("view",[a("text",[t._v("测试1")])])]),a("view",{staticClass:"record-modal-list"},[a("view",[a("text",[t._v("紧急程度")])]),a("view",[a("picker",{attrs:{mode:"selector",range:t.dangerArray,eventid:"5bfe5d08-14"},on:{change:t.dangerChange}},[a("view",[t._v(t._s(t.dangerArray[t.dangerIndex]))])])],1)]),a("view",{staticClass:"record-modal-list"},[a("view",[a("text",[t._v("责任人")])]),a("view",[a("picker",{attrs:{mode:"selector",range:t.managerArray,eventid:"5bfe5d08-15"},on:{change:t.mangerChange}},[a("view",[t._v(t._s(t.managerArray[t.managerIndex]))])])],1)]),a("view",{staticClass:"record-modal-list"},[a("view",[a("text",[t._v("截至日期")])]),a("view",[a("picker",{attrs:{mode:"date",value:t.date,start:t.startDate,end:t.endDate,eventid:"5bfe5d08-16"},on:{change:t.bindDateChange}},[a("view",{staticClass:"uni-input"},[t._v(t._s(t.date))])])],1)]),a("view",{staticClass:"detail-modal-submit",attrs:{eventid:"5bfe5d08-17"},on:{click:t.modalSubmit}},[t._v("确定")])]),a("neil-modal",{attrs:{show:t.helpShow,title:"帮助","show-cancel":!1,eventid:"5bfe5d08-19",mpcomid:"5bfe5d08-4"},on:{close:t.openHelp}})],1)},n=[];a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n})}},[["05af","common/runtime","common/vendor"]]]);